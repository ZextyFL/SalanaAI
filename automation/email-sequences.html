<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email Sequences - GURU AI</title>
    <link rel="stylesheet" href="../css/style.css">
    <script src="https://kit.fontawesome.com/your-kit-code.js"></script>
    <style>
        .sequences-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: var(--blur-xl);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 20px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 28px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 13px;
            color: var(--gray);
        }
        
        .sequences-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 15px;
        }
        
        .tab-btn {
            padding: 10px 20px;
            background: transparent;
            border: none;
            color: var(--gray);
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            border-radius: 10px;
            transition: all 0.3s;
        }
        
        .tab-btn:hover {
            color: white;
            background: rgba(255, 255, 255, 0.05);
        }
        
        .tab-btn.active {
            background: var(--gradient-primary);
            color: white;
        }
        
        .sequences-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .sequence-card {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: var(--blur-xl);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 25px;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .sequence-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: var(--border-glow);
        }
        
        .sequence-card.active::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 60px;
            height: 60px;
            background: var(--success);
            clip-path: polygon(100% 0, 0 0, 100% 100%);
            opacity: 0.3;
        }
        
        .sequence-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .sequence-name {
            font-size: 18px;
            font-weight: 600;
        }
        
        .sequence-type {
            padding: 4px 12px;
            background: rgba(99, 102, 241, 0.2);
            border-radius: 20px;
            color: var(--primary);
            font-size: 11px;
            font-weight: 600;
        }
        
        .sequence-stats {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-number {
            font-size: 20px;
            font-weight: 700;
            color: var(--primary);
        }
        
        .stat-desc {
            font-size: 11px;
            color: var(--gray);
        }
        
        .email-preview {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            padding: 15px;
            margin: 15px 0;
            font-size: 13px;
            border-left: 3px solid var(--primary);
        }
        
        .email-subject {
            font-weight: 600;
            margin-bottom: 5px;
            color: white;
        }
        
        .email-body {
            color: var(--gray);
            font-size: 12px;
            line-height: 1.5;
        }
        
        .sequence-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .status-toggle {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .status-toggle input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255,255,255,0.2);
            transition: .3s;
            border-radius: 34px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 2px;
            bottom: 2px;
            background-color: white;
            transition: .3s;
            border-radius: 50%;
        }
        
        input:checked + .toggle-slider {
            background: var(--gradient-primary);
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }
        
        .create-sequence-btn {
            background: var(--gradient-primary);
            border: none;
            padding: 12px 24px;
            border-radius: 15px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .create-sequence-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--border-glow);
        }
        
        .metrics-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 15px 0;
        }
        
        .metric-box {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            padding: 12px;
            text-align: center;
        }
        
        .metric-label-small {
            font-size: 11px;
            color: var(--gray);
            margin-bottom: 4px;
        }
        
        .metric-value-small {
            font-size: 16px;
            font-weight: 600;
            color: white;
        }
        
        .template-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            padding: 4px 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            font-size: 10px;
            color: var(--gray);
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            width: 600px;
            max-width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            background: var(--dark);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
        }
        
        .modal-title {
            font-size: 24px;
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--gray);
            font-size: 13px;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            color: white;
            font-size: 14px;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .email-step {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            position: relative;
        }
        
        .step-number {
            position: absolute;
            top: -10px;
            left: 20px;
            background: var(--primary);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 14px;
        }
        
        .remove-step {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            color: var(--danger);
            cursor: pointer;
            font-size: 16px;
        }
        
        .add-step-btn {
            width: 100%;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px dashed rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            color: white;
            cursor: pointer;
            margin: 20px 0;
            transition: all 0.3s;
        }
        
        .add-step-btn:hover {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.1);
        }
        
        .ai-suggestions {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(236, 72, 153, 0.1) 100%);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .suggestion-item {
            padding: 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .suggestion-item:hover {
            background: var(--primary);
        }
    </style>
</head>
<body>
    <div style="padding: 20px;">
        <div class="sequences-header">
            <h2 style="font-size: 24px;">üìß Email Sequences</h2>
            <button class="create-sequence-btn" onclick="showCreateModal()">
                <i class="fas fa-plus"></i> Create Sequence
            </button>
        </div>

        <!-- Stats Grid -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value" id="totalEmails">12,345</div>
                <div class="stat-label">Emails Sent (30d)</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="openRate">42.3%</div>
                <div class="stat-label">Avg. Open Rate</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="clickRate">18.7%</div>
                <div class="stat-label">Avg. Click Rate</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="conversionRate">3.2%</div>
                <div class="stat-label">Conversion Rate</div>
            </div>
        </div>

        <!-- Tabs -->
        <div class="sequences-tabs">
            <button class="tab-btn active" onclick="filterSequences('all')">All Sequences</button>
            <button class="tab-btn" onclick="filterSequences('welcome')">Welcome</button>
            <button class="tab-btn" onclick="filterSequences('abandoned')">Abandoned Cart</button>
            <button class="tab-btn" onclick="filterSequences('post-purchase')">Post-Purchase</button>
            <button class="tab-btn" onclick="filterSequences('re-engagement')">Re-engagement</button>
        </div>

        <!-- Sequences Grid -->
        <div class="sequences-grid" id="sequencesGrid">
            <!-- Will be populated by JS -->
        </div>
    </div>

    <!-- Create Sequence Modal -->
    <div class="modal" id="createModal">
        <div class="modal-content">
            <h3 class="modal-title">Create Email Sequence</h3>
            
            <div class="form-group">
                <label>Sequence Name</label>
                <input type="text" id="seqName" placeholder="e.g., Welcome Series">
            </div>
            
            <div class="form-group">
                <label>Sequence Type</label>
                <select id="seqType">
                    <option value="welcome">Welcome Series</option>
                    <option value="abandoned">Abandoned Cart</option>
                    <option value="post-purchase">Post-Purchase</option>
                    <option value="re-engagement">Re-engagement</option>
                    <option value="custom">Custom</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Trigger</label>
                <select id="seqTrigger">
                    <option value="signup">When customer signs up</option>
                    <option value="purchase">After first purchase</option>
                    <option value="cart">When cart is abandoned</option>
                    <option value="inactive">After 30 days inactive</option>
                    <option value="birthday">On customer's birthday</option>
                </select>
            </div>
            
            <!-- AI Suggestions -->
            <div class="ai-suggestions">
                <h4 style="margin-bottom: 10px;">ü§ñ AI Suggestions</h4>
                <div class="suggestion-item" onclick="useTemplate('welcome')">
                    <strong>Welcome Series Template</strong>
                    <p style="font-size: 12px; color: var(--gray);">5 emails ‚Ä¢ 42% avg open rate</p>
                </div>
                <div class="suggestion-item" onclick="useTemplate('abandoned')">
                    <strong>Abandoned Cart Recovery</strong>
                    <p style="font-size: 12px; color: var(--gray);">3 emails ‚Ä¢ 28% recovery rate</p>
                </div>
                <div class="suggestion-item" onclick="useTemplate('post')">
                    <strong>Post-Purchase Upsell</strong>
                    <p style="font-size: 12px; color: var(--gray);">4 emails ‚Ä¢ 15% upsell rate</p>
                </div>
            </div>
            
            <!-- Email Steps -->
            <h4 style="margin: 20px 0 10px;">Email Steps</h4>
            <div id="emailSteps">
                <!-- Steps will be added here -->
            </div>
            
            <button class="add-step-btn" onclick="addEmailStep()">
                <i class="fas fa-plus"></i> Add Email
            </button>
            
            <div style="display: flex; gap: 15px; margin-top: 20px;">
                <button class="btn" style="flex: 1;" onclick="saveSequence()">Create Sequence</button>
                <button class="btn" style="flex: 1; background: transparent;" onclick="closeModal()">Cancel</button>
            </div>
        </div>
    </div>

    <script>
        let sequences = [
            {
                id: 1,
                name: 'Welcome Series',
                type: 'welcome',
                trigger: 'New Signup',
                active: true,
                stats: {
                    sent: 3456,
                    opened: 1482,
                    clicked: 567,
                    converted: 89
                },
                emails: [
                    { day: 0, subject: 'Welcome to the family!', content: 'Thanks for joining...' },
                    { day: 2, subject: 'Here\'s 10% off your first order', content: 'Use code WELCOME10...' },
                    { day: 5, subject: 'Products you might like', content: 'Based on your interests...' }
                ]
            },
            {
                id: 2,
                name: 'Abandoned Cart Recovery',
                type: 'abandoned',
                trigger: 'Cart Abandoned (1 hour)',
                active: true,
                stats: {
                    sent: 1234,
                    opened: 542,
                    clicked: 287,
                    converted: 156
                },
                emails: [
                    { day: 0, subject: 'Forgot something?', content: 'Your cart is waiting...' },
                    { day: 1, subject: 'Still thinking about it?', content: 'Here\'s free shipping...' },
                    { day: 3, subject: 'Last chance! 20% off', content: 'Don\'t miss out...' }
                ]
            },
            {
                id: 3,
                name: 'Post-Purchase Thank You',
                type: 'post-purchase',
                trigger: 'Order Completed',
                active: true,
                stats: {
                    sent: 5678,
                    opened: 3123,
                    clicked: 1567,
                    converted: 234
                },
                emails: [
                    { day: 0, subject: 'Thank you for your order!', content: 'Your order #1234...' },
                    { day: 3, subject: 'How do you like it?', content: 'Leave a review...' },
                    { day: 7, subject: 'Complete your look', content: 'Customers also bought...' },
                    { day: 30, subject: 'Time for a refill?', content: 'Here\'s 15% off...' }
                ]
            },
            {
                id: 4,
                name: 'Re-engagement Campaign',
                type: 're-engagement',
                trigger: '90 days inactive',
                active: false,
                stats: {
                    sent: 892,
                    opened: 214,
                    clicked: 78,
                    converted: 23
                },
                emails: [
                    { day: 0, subject: 'We miss you!', content: 'Come back for 20% off...' },
                    { day: 7, subject: 'Last chance to save', content: 'Your discount expires...' }
                ]
            },
            {
                id: 5,
                name: 'Birthday Series',
                type: 'custom',
                trigger: 'Customer Birthday',
                active: true,
                stats: {
                    sent: 234,
                    opened: 187,
                    clicked: 98,
                    converted: 45
                },
                emails: [
                    { day: -7, subject: 'Your birthday is coming up!', content: 'Here\'s a special gift...' },
                    { day: 0, subject: 'Happy Birthday! üéÇ', content: 'Enjoy 25% off...' }
                ]
            }
        ];

        let emailStepCount = 1;

        // Load sequences
        function loadSequences(filter = 'all') {
            const grid = document.getElementById('sequencesGrid');
            
            let filteredSequences = sequences;
            if (filter !== 'all') {
                filteredSequences = sequences.filter(s => s.type === filter);
            }
            
            grid.innerHTML = filteredSequences.map(s => {
                const openRate = ((s.stats.opened / s.stats.sent) * 100).toFixed(1);
                const clickRate = ((s.stats.clicked / s.stats.sent) * 100).toFixed(1);
                const conversionRate = ((s.stats.converted / s.stats.sent) * 100).toFixed(1);
                
                return `
                    <div class="sequence-card ${s.active ? 'active' : ''}">
                        <div class="template-badge">${s.emails.length} emails</div>
                        <div class="sequence-header">
                            <span class="sequence-name">${s.name}</span>
                            <span class="sequence-type">${s.type.replace('-', ' ').toUpperCase()}</span>
                        </div>
                        
                        <div style="font-size: 13px; color: var(--gray); margin-bottom: 10px;">
                            <i class="fas fa-bolt"></i> Trigger: ${s.trigger}
                        </div>
                        
                        <div class="sequence-stats">
                            <div class="stat-item">
                                <div class="stat-number">${openRate}%</div>
                                <div class="stat-desc">Open Rate</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number">${clickRate}%</div>
                                <div class="stat-desc">Click Rate</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number">${conversionRate}%</div>
                                <div class="stat-desc">Conversion</div>
                            </div>
                        </div>
                        
                        <div class="email-preview">
                            <div class="email-subject">üìß ${s.emails[0].subject}</div>
                            <div class="email-body">${s.emails[0].content.substring(0, 50)}...</div>
                            <div style="font-size: 10px; color: var(--gray); margin-top: 5px;">Day ${s.emails[0].day}</div>
                        </div>
                        
                        <div class="metrics-row">
                            <div class="metric-box">
                                <div class="metric-label-small">Total Sent</div>
                                <div class="metric-value-small">${s.stats.sent.toLocaleString()}</div>
                            </div>
                            <div class="metric-box">
                                <div class="metric-label-small">Conversions</div>
                                <div class="metric-value-small">${s.stats.converted}</div>
                            </div>
                        </div>
                        
                        <div class="sequence-footer">
                            <button class="action-btn" onclick="editSequence(${s.id})">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="action-btn" onclick="viewStats(${s.id})">
                                <i class="fas fa-chart-bar"></i> Stats
                            </button>
                            <label class="status-toggle">
                                <input type="checkbox" ${s.active ? 'checked' : ''} onchange="toggleSequence(${s.id}, this.checked)">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Filter sequences
        function filterSequences(filter) {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            loadSequences(filter);
        }

        // Toggle sequence
        function toggleSequence(id, status) {
            const sequence = sequences.find(s => s.id === id);
            if (sequence) {
                sequence.active = status;
                window.parent.showToast(`Sequence ${status ? 'activated' : 'paused'}`);
                loadSequences(document.querySelector('.tab-btn.active').textContent.toLowerCase());
            }
        }

        // Edit sequence
        function editSequence(id) {
            window.parent.showToast(`üìù Editing sequence #${id}`);
        }

        // View stats
        function viewStats(id) {
            window.parent.showToast(`üìä Loading detailed statistics...`);
        }

        // Show create modal
        function showCreateModal() {
            document.getElementById('createModal').classList.add('active');
            // Add first email step by default
            addEmailStep();
        }

        // Close modal
        function closeModal() {
            document.getElementById('createModal').classList.remove('active');
            document.getElementById('emailSteps').innerHTML = '';
            emailStepCount = 1;
        }

        // Add email step
        function addEmailStep() {
            const container = document.getElementById('emailSteps');
            const stepDiv = document.createElement('div');
            stepDiv.className = 'email-step';
            stepDiv.id = `step-${emailStepCount}`;
            stepDiv.innerHTML = `
                <div class="step-number">${emailStepCount}</div>
                <button class="remove-step" onclick="removeEmailStep(${emailStepCount})">
                    <i class="fas fa-times"></i>
                </button>
                <div class="form-group">
                    <label>Send After (days)</label>
                    <input type="number" class="step-day" value="${emailStepCount === 1 ? 0 : emailStepCount * 2}" min="0">
                </div>
                <div class="form-group">
                    <label>Email Subject</label>
                    <input type="text" class="step-subject" placeholder="Enter subject line">
                </div>
                <div class="form-group">
                    <label>Email Content</label>
                    <textarea class="step-content" rows="3" placeholder="Write your email content..."></textarea>
                </div>
            `;
            container.appendChild(stepDiv);
            emailStepCount++;
        }

        // Remove email step
        function removeEmailStep(id) {
            const step = document.getElementById(`step-${id}`);
            if (step) {
                step.remove();
                // Renumber remaining steps
                const steps = document.querySelectorAll('.email-step');
                steps.forEach((step, index) => {
                    step.querySelector('.step-number').textContent = index + 1;
                });
                emailStepCount = steps.length + 1;
            }
        }

        // Use template
        function useTemplate(type) {
            if (type === 'welcome') {
                // Clear existing steps
                document.getElementById('emailSteps').innerHTML = '';
                emailStepCount = 1;
                
                // Add welcome template steps
                addStepWithValues(0, 'Welcome to [Store Name]!', 'Thanks for joining! We\'re excited to have you...');
                addStepWithValues(2, 'Here\'s 10% off your first order', 'Use code WELCOME10 at checkout...');
                addStepWithValues(5, 'Products you might like', 'Based on your interests, we think you\'ll love...');
                addStepWithValues(7, 'Share the love', 'Refer a friend and get 20% off...');
                
                document.getElementById('seqName').value = 'Welcome Series';
                document.getElementById('seqType').value = 'welcome';
                document.getElementById('seqTrigger').value = 'signup';
            } else if (type === 'abandoned') {
                document.getElementById('emailSteps').innerHTML = '';
                emailStepCount = 1;
                
                addStepWithValues(0, 'Did you forget something?', 'Your cart is waiting...');
                addStepWithValues(1, 'Still thinking about it?', 'Here\'s free shipping on your order...');
                addStepWithValues(3, 'Last chance! 20% off', 'Don\'t miss out on these items...');
                
                document.getElementById('seqName').value = 'Abandoned Cart Recovery';
                document.getElementById('seqType').value = 'abandoned';
                document.getElementById('seqTrigger').value = 'cart';
            }
            
            window.parent.showToast('‚úÖ Template loaded!');
        }

        // Helper to add step with values
        function addStepWithValues(day, subject, content) {
            const container = document.getElementById('emailSteps');
            const stepDiv = document.createElement('div');
            stepDiv.className = 'email-step';
            stepDiv.id = `step-${emailStepCount}`;
            stepDiv.innerHTML = `
                <div class="step-number">${emailStepCount}</div>
                <button class="remove-step" onclick="removeEmailStep(${emailStepCount})">
                    <i class="fas fa-times"></i>
                </button>
                <div class="form-group">
                    <label>Send After (days)</label>
                    <input type="number" class="step-day" value="${day}" min="0">
                </div>
                <div class="form-group">
                    <label>Email Subject</label>
                    <input type="text" class="step-subject" value="${subject}">
                </div>
                <div class="form-group">
                    <label>Email Content</label>
                    <textarea class="step-content" rows="3">${content}</textarea>
                </div>
            `;
            container.appendChild(stepDiv);
            emailStepCount++;
        }

        // Save sequence
        function saveSequence() {
            const name = document.getElementById('seqName').value;
            const type = document.getElementById('seqType').value;
            const trigger = document.getElementById('seqTrigger').value;
            
            if (!name) {
                window.parent.showToast('‚ö†Ô∏è Please enter a sequence name');
                return;
            }
            
            // Gather email steps
            const steps = [];
            document.querySelectorAll('.email-step').forEach(step => {
                const day = step.querySelector('.step-day').value;
                const subject = step.querySelector('.step-subject').value;
                const content = step.querySelector('.step-content').value;
                
                if (subject && content) {
                    steps.push({ day: parseInt(day), subject, content });
                }
            });
            
            if (steps.length === 0) {
                window.parent.showToast('‚ö†Ô∏è Add at least one email');
                return;
            }
            
            // Create new sequence
            const newSequence = {
                id: sequences.length + 1,
                name: name,
                type: type,
                trigger: document.getElementById('seqTrigger').options[document.getElementById('seqTrigger').selectedIndex].text,
                active: true,
                stats: {
                    sent: 0,
                    opened: 0,
                    clicked: 0,
                    converted: 0
                },
                emails: steps
            };
            
            sequences.push(newSequence);
            loadSequences();
            closeModal();
            window.parent.showToast('‚úÖ Email sequence created!');
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadSequences();
        });
    </script>
</body>
</html>